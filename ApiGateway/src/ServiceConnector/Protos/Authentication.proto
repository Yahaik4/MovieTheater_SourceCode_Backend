syntax = "proto3";

option csharp_namespace = "AuthenticationGrpc";

package Authentication;

service AuthenticationGrpcService {
	rpc Login(LoginGrpcRequestDTO) returns (LoginGrpcReplyDTO);
	rpc RefreshToken(RefreshTokenGrpcRequestDTO) returns (RefreshTokenGrpcReplyDTO);
	rpc Logout(RefreshTokenGrpcRequestDTO) returns (LogoutGrpcReplyDTO);
	rpc Register(RegisterGrpcRequestDTO) returns (RegisterGrpcReplyDTO);
	rpc VerifyAccount(VerifyAccountGrpcRequestDTO) returns (VerifyAccountGrpcReplyDTO);
	rpc ResendOTP(ResendOTPRequest) returns (ResendOTPReply);
	rpc ResetPassword(ResetPasswordRequest) returns (ResetpassWordReply);
	rpc VerifyResetPassword(ResetPasswordRequest) returns (ResetpassWordReply);
}

message LoginGrpcRequestDTO {
	string Email = 1;
	string Password = 2;
}

message LoginGrpcReplyDTO {
	bool Result = 1;
	string Message = 2;
	int32 StatusCode = 3;
	LoginGrpcReplyDataDTO Data = 4;
}

message LoginGrpcReplyDataDTO {
	string AccessToken = 1;
	string RefreshToken = 2;
}

message RefreshTokenGrpcRequestDTO {
	string RefreshToken = 1;
}

message RefreshTokenGrpcReplyDTO {
	bool Result = 1;
	string Message = 2;
	int32 StatusCode = 3;
	RefreshTokenGrpcReplyDataDTO Data = 4;
}

message RefreshTokenGrpcReplyDataDTO {
	string AccessToken = 1;
}

message LogoutGrpcReplyDTO {
	bool Result = 1;
	string Message = 2;
	int32 StatusCode = 3;
}

message RegisterGrpcRequestDTO {
	string FullName = 1;
	string Email = 2;
	string Password = 3;
}

message RegisterGrpcReplyDTO {
	bool Result = 1;
	string Message = 2;
	int32 StatusCode = 3;
	RegisterGrpcReplyDataDTO Data = 4;
}

message RegisterGrpcReplyDataDTO {
	string userId = 1;
}

message VerifyAccountGrpcRequestDTO {
	string userId = 1;
}

message VerifyAccountGrpcReplyDTO {
	bool Result = 1;
	string Message = 2;
	int32 StatusCode = 3;
}

message ResendOTPRequest {
  string email = 1;
  string purpose = 2;
}

message ResendOTPReply {
  bool result = 1;
  string message = 2;
  int32 statusCode = 3;
  ResendOTPReplyData data = 4;
}

message ResendOTPReplyData {
  string code = 1;
  string expiry = 2;
}

message ResetPasswordRequest {
  string email = 1;
  string otp = 2;
  string newPassword = 3;
}

message ResetpassWordReply {
  bool result = 1;
  string message = 2;
  int32 statusCode = 3;
}