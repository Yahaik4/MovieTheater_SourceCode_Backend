syntax = "proto3";

option csharp_namespace = "AuthenticationGrpc";

package Authentication;

service AuthenticationGrpcService {
	rpc Login(LoginGrpcRequestDTO) returns (LoginGrpcReplyDTO);
	rpc RefreshToken(RefreshTokenGrpcRequestDTO) returns (RefreshTokenGrpcReplyDTO);
	rpc Logout(RefreshTokenGrpcRequestDTO) returns (LogoutGrpcReplyDTO);
	rpc Register(RegisterGrpcRequestDTO) returns (RegisterGrpcReplyDTO);
	rpc RequestChangePassword(ChangePasswordGrpcRequestDTO) returns (ChangePasswordGrpcReplyDTO);
	rpc ConfirmChangePassword(ConfirmChangePasswordGrpcRequestDTO) returns (ConfirmChangePasswordGrpcReplyDTO);
}

message LoginGrpcRequestDTO {
	string Email = 1;
	string Password = 2;
}

message LoginGrpcReplyDTO {
	bool Result = 1;
	string Message = 2;
	int32 StatusCode = 3;
	LoginGrpcReplyDataDTO Data = 4;
}

message LoginGrpcReplyDataDTO {
	string AccessToken = 1;
	string RefreshToken = 2;
}

message RefreshTokenGrpcRequestDTO {
	string RefreshToken = 1;
}

message RefreshTokenGrpcReplyDTO {
	bool Result = 1;
	string Message = 2;
	int32 StatusCode = 3;
	RefreshTokenGrpcReplyDataDTO Data = 4;
}

message RefreshTokenGrpcReplyDataDTO {
	string AccessToken = 1;
}

message LogoutGrpcReplyDTO {
	bool Result = 1;
	string Message = 2;
	int32 StatusCode = 3;
}

message RegisterGrpcRequestDTO {
	string FullName = 1;
	string Email = 2;
	string Password = 3;
}

message RegisterGrpcReplyDTO {
	bool Result = 1;
	string Message = 2;
	int32 StatusCode = 3;
}

message ChangePasswordGrpcRequestDTO {
	string Email = 1;
	string OldPassword = 2;
	string NewPassword = 3;
}

message ChangePasswordGrpcReplyDataDTO {
	string Email = 1;
	bool IsOtpSent = 2;
}

message ChangePasswordGrpcReplyDTO {
	bool Result = 1;
	string Message = 2;
	int32 StatusCode = 3;
	ChangePasswordGrpcReplyDataDTO Data = 4;
}


message ConfirmChangePasswordGrpcRequestDTO {
	string Email = 1;
	string Otp = 2;
}

message ConfirmChangePasswordGrpcReplyDataDTO {
	string Email = 1;
	bool IsOtpValid = 2;
	bool IsPasswordChanged = 3;
}

message ConfirmChangePasswordGrpcReplyDTO {
	bool Result = 1;
	string Message = 2;
	int32 StatusCode = 3;
	ConfirmChangePasswordGrpcReplyDataDTO Data = 4;
}